<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="USBPcap open source USB sniffer for Windows." />
<meta name="keywords" content="USBPcap, opensource, windows, usb, sniffer" />
<title>USBPcap - Wireshark dissectors</title>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>

<!-- Add jQuery library -->
<script type="text/javascript" src="js/jquery-1.9.0.min.js"></script>
<!-- Add mousewheel plugin (this is optional) -->
<script type="text/javascript" src="js/jquery.mousewheel-3.0.6.pack.js"></script>
<!-- Add fancyBox main JS and CSS files -->
<script type="text/javascript" src="js/jquery.fancybox.js?v=2.1.4"></script>
<link rel="stylesheet" type="text/css" href="js/jquery.fancybox.css?v=2.1.4" media="screen" />
<script type="text/javascript">
$(document).ready(function() {
$(".fancybox").fancybox({
        openEffect	: 'none',
        closeEffect	: 'none'
});
})
</script>
<style type="text/css">
        .fancybox-custom .fancybox-skin {
                box-shadow: 0 0 50px #222;
        }
</style>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6085094-1");
pageTracker._trackPageview();
</script>


<body>

<div id="container">

<div id="header"><h1>Open Source USB Packet capture for Windows</h1></div>

<div id="sub_header">... works on XP, Vista, 7, 8 and 10</div>

<div id="main_content_top"></div>

<div id="main_content">

<div class="content">


<h2>Wireshark dissectors overview</h2>
<p>
Dissectors deode the captured data. As a result of dissection, user is presented with easy to read details of transmitted data.
More information about dissectors can be found in <a href="http://www.wireshark.org/docs/wsdg_html_chunked/ChapterDissection.html">Wireshark Developer's Guide Chapter 9. Packet dissection</a>.
During Sharkfest 2013 there was <a href="http://sharkfest.wireshark.org/sharkfest.13/presentations/PA-10_Writing-a-Wireshark-Dissector_Graham-Bloice.zip">PA 10: Writing Wireshark Dissector</a> presentation.
</p>

<p>
Data flow between dissectors is shown on figure 1.
Each box represents single dissector. In the top part of box there are possible input data source names (dissector source code is in wireshark/epan/dissectors directory). In the middle of the box there is source filename of particular dissector. In the bottom of the box there are possible output data names.
</p>

<p>
<center>
<a class="fancybox" rel="capture" href="images/wireshark_dissectors.png" title="Figure 1: Wireshark dissectors overview.">
<img src="images/wireshark_dissectors_small.png" alt=""/>
</a><br/>
Figure 1: Wireshark dissectors overview.
</center>
</p>

<p>
<i>packet-frame.c</i> is the top-level dissector that reads pcap files. <i>packet-usb.c</i> knows how to decode the pseudo-headers from Linux (WTAP_ENCAP_USB) and Windows (WTAP_ENCAP_USBPCAP) packets. Moreover <i>packet-usb.c</i> parses USB standard descriptors and outputs the data (bulk, interrupt and control) for additional dissection.
In order to make the right dissector process the data (for example, bulk), <i>packet-usb.c</i> should have parsed the USB descriptors to know the USB class the device conforms to.
This is why you should plug the device in after starting capture.
</p>

<h3>Writing USB class dissector</h3>
<p>
This is not complete guide, for detailed information about how to write dissector check out the Developer's Guide.
</p>
<p>
When writing USB class dissector you will be mostly interested in following dissector tables:
<ul>
    <li>usb.bulk</li>
    <li>usb.interrput</li>
    <li>usb.control</li>
</ul>
Currently Wireshark does not have dissectors for USB isochronous transfers.
To register your dissector for dissecting bulk data of some USB class you call following function:
<pre>dissector_add_uint("usb.bulk", IF_CLASS_XXX, handle);</pre>
IF_CLASS_XXX is one of the IF_CLASS_ defines from packet-usb.h.
</p>

<p>
Once you write Wireshark USB dissector it most likely will work out-of-box both with USBPcap traces and Linux USB captures. This was the case for USB Audio dissector.
You can view the source code for <a href="http://code.wireshark.org/git/?p=wireshark;a=blob;f=epan/dissectors/packet-usb-audio.c;hb=HEAD">USB Audio dissector online</a>.
</p>

</div>


<div class="menu">

<div class="menu_title">USBPcap</div>
<ul>
<li><a href="index.html" class="menu_link">Main page</a></li>
<li><a href="tour.html" class="menu_link">Illustrated Tour</a></li>
<li><a href="captureformat.html" class="menu_link">Capture format</a></li>
<li><a href="capture_limitations.html" class="menu_link">Capture limitations</a></li>
<li><a href="donors.html" class="menu_link">Donors</a></li>
</ul>

<div class="menu_title">Develop</div>
<ul>
<li><a href="develop.html" class="menu_link">Develop</a></li>
<li><a href="block_diagram.html" class="menu_link">Block diagram</a></li>
<li><a href="capture_buffer.html" class="menu_link">Capture buffer</a></li>
<li><a href="dissectors.html" class="menu_link">Wireshark dissectors</a></li>
<li><a href="todo.html" class="menu_link">USBPcap TODO</a></li>
</ul>

<div class="menu_title">Links</div>
<ul>
<li><a href="https://github.com/desowin/usbpcap" class="menu_link">GitHub project page</a></li>
<li><a href="https://github.com/desowin/usbpcap/issues?state=open" class="menu_link">Report issue</a></li>
<li><a href="https://github.com/desowin/usbpcap/commits/master/" class="menu_link">Changelog</a></li>
<li><a href="https://github.com/desowin/usbpcap/wiki/" class="menu_link">Wiki</a></li>
</ul>


<a href="https://twitter.com/USBPcap" class="twitter-follow-button" data-show-count="false">Follow @USBPcap</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<script type="text/javascript" src="http://www.ohloh.net/p/634708/widgets/project_thin_badge.js"></script>

<table style="background-color: #fff; padding: 1px;" cellspacing=0>
<tr><td align=right>
  <a href="http://groups.google.com/group/usbpcap">Visit USBPcap group</a>
</td></tr>
</table>
</div>


<div id="clear"></div>

</div>

<div id="main_content_bottom">
</div>

<div id="footer"><a href="#">Back to top</a> | <a href="http://desowin.org">my homepage</a></div>

</div>

</body>

</html>
